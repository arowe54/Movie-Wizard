{% extends "layout.html" %}

{% block title %}
    Profile
{% endblock %}

{% block main %}
<!--Show username-->
<button>
    <p>Username: {{ username }}</p>
</button>
<!--Show password-->
<button>
    <p>Password: <span style="-webkit-text-security: disc" name="original_pwd" id="original_pwd">{{ session["password"] }}</span></p>
    <!--TODO: Change from click to show when clicked and held, also change button to icon -->
    <button name="show_password" id="show_password" onclick="showPassword('original_pwd')">Show Password</button>
</button>


<div class="row">
    <div class="col">
        <!--Change username-->
        <button type="text" name="update_username" id="update_username">Change Username</button>
        <div id="update_username_form" class="container">
            <p> Username: {{ username }} </p>
            <form name="change_username" action="/update_user" method="post">
                <p> New Username:
                    <input type="text" name="new_username" id="new_username" autocomplete="off">
                    <button type="submit">Submit</button>
                </p>
            </form>
        </div>
    </div>

    <div class="col">
        <!--Change password-->
        <button type="text" name="update_pwd" id="update_pwd">Change Password</button>
        <div id="update_pwd_form">
            <p> Current Password: <span style="-webkit-text-security: disc" id="show_pwd2">{{ session["password"] }}</span> </p>
            <!--Make button show password-->
            <button onclick="showPassword('show_pwd2')">Show password</button>
            <form name="change_pwd" action="/update_user" method="post">
                <p> New Password:
                    <input type="password" name="new_pwd" id="new_pwd">
                    <button type="submit">Submit</button>
                </p>
            </form>
        </div>
    </div>
</div>


<!--TODO: Add preferences (ex. isAdult == false, fav genre, idk)(maybe not bc of time)(do last)-->

<script>
    $(document).ready(function() {
        // Function doesn't work, but jquery below does?
        // When user clicks show password button
        function showPassword(id) {
            style = document.getElementById(id).getAttribute('style');
            if (style == '-webkit-text-security: disc'){
                // Show password
                document.getElementById(id).setAttribute('style', '-webkit-text-security: none')
            }
            else {
                // Encrypt password
                document.getElementById(id).setAttribute('style', '-webkit-text-security: disc');
            }
        }
        /*
        $('#show_password').click(function() {
            // Save original style
            style = $('#original_pwd').attr('style');

            // If its already hidden
            if (style == '-webkit-text-security: disc'){
                // Show password
                $('#original_pwd').attr('style', '-webkit-text-security: none');
            }
            else {
                // Encrypt password
                $('#original_pwd').attr('style', '-webkit-text-security: disc');
            }
        })
        */

        // Hide both divs before they can be clicked
        $("#update_username_form").hide()
        $('#update_pwd_form').hide()

        // When user clicks update username
        $('#update_username').click(function() {
            $("#update_username_form").toggle()
        })

        // When user clicks update password
        $('#update_pwd').click(function() {
            // Append a form just below the change username button
            $('#update_pwd_form').toggle()
        })
    })
</script>

{% endblock %}